<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Qu·∫£n L√Ω Kho H√†ng</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .chat-container {
            width: 100%;
            max-width: 500px;
            height: 700px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .chat-header h1 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .chat-header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .file-upload-section {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-status {
            flex: 1;
            font-size: 14px;
            color: #666;
        }

        .file-status.loaded {
            color: #10b981;
            font-weight: 500;
        }

        .upload-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }

        .upload-btn:hover {
            background: #2563eb;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #fafafa;
        }

        .message {
            margin-bottom: 16px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }

        .message.bot .message-avatar {
            background: #e0e7ff;
        }

        .message.user .message-avatar {
            background: #dbeafe;
        }

        .message-content {
            max-width: 70%;
        }

        .message-bubble {
            padding: 12px 16px;
            border-radius: 16px;
            font-size: 15px;
            line-height: 1.5;
        }

        .message.bot .message-bubble {
            background: white;
            color: #333;
            border-bottom-left-radius: 4px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        .message.user .message-bubble {
            background: #3b82f6;
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message-time {
            font-size: 12px;
            color: #9ca3af;
            margin-top: 4px;
        }

        .message.user .message-time {
            text-align: right;
        }

        .data-table {
            margin: 8px 0;
            border-collapse: collapse;
            width: 100%;
            font-size: 13px;
            background: white;
            border-radius: 6px;
            overflow: hidden;
        }

        .data-table th, .data-table td {
            border: 1px solid #e5e7eb;
            padding: 8px 12px;
            text-align: left;
        }

        .data-table th {
            background: #f3f4f6;
            font-weight: 600;
            color: #374151;
        }

        .data-table tr:nth-child(even) {
            background: #f9fafb;
        }

        .highlight {
            background: #fef3c7;
            font-weight: 500;
        }

        .low-stock {
            color: #ef4444;
            font-weight: 600;
        }

        .in-stock {
            color: #10b981;
            font-weight: 600;
        }

        .chat-input-section {
            padding: 20px;
            background: white;
            border-top: 1px solid #e9ecef;
        }

        .quick-questions {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .quick-btn {
            background: #eff6ff;
            color: #3b82f6;
            border: 1px solid #dbeafe;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-btn:hover {
            background: #dbeafe;
            transform: scale(1.05);
        }

        .input-container {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 24px;
            font-size: 15px;
            transition: border-color 0.3s;
        }

        .chat-input:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .send-btn {
            background: #3b82f6;
            color: white;
            border: none;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .send-btn:hover {
            background: #2563eb;
            transform: scale(1.05);
        }

        .send-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }

        .loading-dots {
            display: inline-flex;
            gap: 4px;
        }

        .loading-dots span {
            width: 8px;
            height: 8px;
            background: #6b7280;
            border-radius: 50%;
            animation: bounce 1.4s infinite;
        }

        .loading-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .loading-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes bounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .info-message {
            background: #eff6ff;
            border: 1px solid #dbeafe;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            color: #1e40af;
            margin: 8px 0;
        }

        .warning-message {
            background: #fef3c7;
            border: 1px solid #fde68a;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            color: #92400e;
            margin: 8px 0;
        }

        .success-message {
            background: #d1fae5;
            border: 1px solid #a7f3d0;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            color: #065f46;
            margin: 8px 0;
        }

        input[type="file"] {
            display: none;
        }

        @media (max-width: 600px) {
            .chat-container {
                height: 100vh;
                max-width: 100%;
                border-radius: 0;
            }
            
            .message-bubble {
                max-width: 85%;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <h1>ü§ñ Tr·ª£ L√Ω Qu·∫£n L√Ω Kho</h1>
            <p>H·ªèi b·∫•t c·ª© ƒëi·ªÅu g√¨ v·ªÅ t·ªìn kho c·ªßa b·∫°n</p>
        </div>
        
        <div class="file-upload-section">
            <div class="file-status" id="fileStatus">
                üìÅ Ch∆∞a t·∫£i file d·ªØ li·ªáu kho
            </div>
            <input type="file" id="fileInput" accept=".xlsx,.xls,.csv">
            <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                T·∫£i file Excel
            </button>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="message bot">
                <div class="message-avatar">ü§ñ</div>
                <div class="message-content">
                    <div class="message-bubble">
                        Xin ch√†o! T√¥i l√† tr·ª£ l√Ω qu·∫£n l√Ω kho c·ªßa b·∫°n. Vui l√≤ng t·∫£i file Excel ch·ª©a d·ªØ li·ªáu kho h√†ng ƒë·ªÉ b·∫Øt ƒë·∫ßu.
                        <div class="info-message">
                            üí° File Excel c·∫ßn c√≥ c√°c c·ªôt: M√£ h√†ng, T√™n h√†ng, S·ªë l∆∞·ª£ng t·ªìn, ƒê∆°n v·ªã, Gi√° tr·ªã...
                        </div>
                    </div>
                    <div class="message-time">V·ª´a xong</div>
                </div>
            </div>
        </div>
        
        <div class="chat-input-section">
            <div class="quick-questions" id="quickQuestions" style="display: none;">
                <button class="quick-btn" onclick="askQuickQuestion('T·ªïng s·ªë m·∫∑t h√†ng trong kho?')">T·ªïng m·∫∑t h√†ng</button>
                <button class="quick-btn" onclick="askQuickQuestion('H√†ng n√†o s·∫Øp h·∫øt?')">H√†ng s·∫Øp h·∫øt</button>
                <button class="quick-btn" onclick="askQuickQuestion('Gi√° tr·ªã t·ªìn kho?')">Gi√° tr·ªã kho</button>
            </div>
            
            <div class="input-container">
                <input type="text" 
                       id="chatInput" 
                       class="chat-input" 
                       placeholder="H·ªèi v·ªÅ t·ªìn kho..." 
                       disabled>
                <button class="send-btn" id="sendBtn" onclick="sendMessage()" disabled>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Global variables
        let inventoryData = [];
        let headers = [];
        
        // File upload handling
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                readExcelFile(file);
            }
        });
        
        function readExcelFile(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Get first sheet
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                    
                    // Extract headers and data
                    headers = jsonData[0];
                    inventoryData = jsonData.slice(1).map(row => {
                        const obj = {};
                        headers.forEach((header, index) => {
                            obj[header] = row[index];
                        });
                        return obj;
                    });
                    
                    // Update UI
                    document.getElementById('fileStatus').innerHTML = `‚úÖ ƒê√£ t·∫£i: ${file.name} (${inventoryData.length} m·∫∑t h√†ng)`;
                    document.getElementById('fileStatus').classList.add('loaded');
                    document.getElementById('chatInput').disabled = false;
                    document.getElementById('sendBtn').disabled = false;
                    document.getElementById('quickQuestions').style.display = 'flex';
                    
                    // Show success message
                    addBotMessage(`Tuy·ªát v·ªùi! T√¥i ƒë√£ t·∫£i th√†nh c√¥ng file "${file.name}" v·ªõi ${inventoryData.length} m·∫∑t h√†ng. 

M·ªôt s·ªë th√¥ng tin t√¥i c√≥ th·ªÉ tr·∫£ l·ªùi:
‚Ä¢ S·ªë l∆∞·ª£ng t·ªìn kho c·ªßa t·ª´ng m·∫∑t h√†ng
‚Ä¢ M·∫∑t h√†ng n√†o s·∫Øp h·∫øt h√†ng
‚Ä¢ T·ªïng gi√° tr·ªã t·ªìn kho
‚Ä¢ T√¨m ki·∫øm m·∫∑t h√†ng theo m√£ ho·∫∑c t√™n

B·∫°n mu·ªën bi·∫øt g√¨ v·ªÅ kho h√†ng?`);
                    
                } catch (error) {
                    alert('L·ªói khi ƒë·ªçc file: ' + error.message);
                }
            };
            
            reader.readAsArrayBuffer(file);
        }
        
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addUserMessage(message);
            
            // Clear input
            input.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            // Process message after delay
            setTimeout(() => {
                hideTypingIndicator();
                processQuery(message);
            }, 500);
        }
        
        function processQuery(query) {
            const lowerQuery = query.toLowerCase();
            
            // Check inventory quantity queries
            if (lowerQuery.includes('s·ªë l∆∞·ª£ng') || lowerQuery.includes('t·ªìn kho') || lowerQuery.includes('c√≤n bao nhi√™u')) {
                checkInventoryQuantity(query);
            }
            // Check for low stock items
            else if (lowerQuery.includes('s·∫Øp h·∫øt') || lowerQuery.includes('h·∫øt h√†ng') || lowerQuery.includes('c·∫ßn nh·∫≠p')) {
                checkLowStock();
            }
            // Total inventory value
            else if (lowerQuery.includes('gi√° tr·ªã') || lowerQuery.includes('t·ªïng ti·ªÅn')) {
                calculateInventoryValue();
            }
            // Total items
            else if (lowerQuery.includes('t·ªïng s·ªë') || lowerQuery.includes('c√≥ bao nhi√™u m·∫∑t h√†ng')) {
                showTotalItems();
            }
            // Search for items
            else if (lowerQuery.includes('t√¨m') || lowerQuery.includes('search')) {
                searchItems(query);
            }
            // Show all items
            else if (lowerQuery.includes('hi·ªÉn th·ªã') || lowerQuery.includes('xem t·∫•t c·∫£')) {
                showAllItems();
            }
            // Product details
            else if (lowerQuery.includes('th√¥ng tin') || lowerQuery.includes('chi ti·∫øt')) {
                showProductDetails(query);
            }
            else {
                // Try to find product name in query
                findProductInQuery(query);
            }
        }
        
        function checkInventoryQuantity(query) {
            // Extract product name or code from query
            const words = query.split(' ');
            let foundItems = [];
            
            // Try to find product in inventory
            inventoryData.forEach(item => {
                const itemName = (item['T√™n h√†ng'] || item['T√™n s·∫£n ph·∫©m'] || item['Product'] || '').toLowerCase();
                const itemCode = (item['M√£ h√†ng'] || item['M√£'] || item['SKU'] || item['Code'] || '').toLowerCase();
                
                words.forEach(word => {
                    if (word.length > 2 && (itemName.includes(word.toLowerCase()) || itemCode.includes(word.toLowerCase()))) {
                        foundItems.push(item);
                    }
                });
            });
            
            // Remove duplicates
            foundItems = [...new Set(foundItems)];
            
            if (foundItems.length === 0) {
                addBotMessage('‚ùå Kh√¥ng t√¨m th·∫•y m·∫∑t h√†ng n√†o ph√π h·ª£p. Vui l√≤ng th·ª≠ l·∫°i v·ªõi t√™n ho·∫∑c m√£ ch√≠nh x√°c h∆°n.');
            } else if (foundItems.length === 1) {
                const item = foundItems[0];
                const quantity = item['S·ªë l∆∞·ª£ng'] || item['S·ªë l∆∞·ª£ng t·ªìn'] || item['T·ªìn kho'] || item['Quantity'] || 0;
                const unit = item['ƒê∆°n v·ªã'] || item['Unit'] || 'c√°i';
                const name = item['T√™n h√†ng'] || item['T√™n s·∫£n ph·∫©m'] || item['Product'];
                const code = item['M√£ h√†ng'] || item['M√£'] || item['SKU'] || item['Code'];
                
                let message = `üì¶ **${name}** (M√£: ${code})\n`;
                message += `S·ªë l∆∞·ª£ng t·ªìn kho: **${quantity} ${unit}**\n\n`;
                
                if (quantity < 10) {
                    message += `<div class="warning-message">‚ö†Ô∏è C·∫£nh b√°o: S·∫Øp h·∫øt h√†ng!</div>`;
                } else {
                    message += `<div class="success-message">‚úÖ C√≤n h√†ng</div>`;
                }
                
                addBotMessage(message);
            } else {
                let message = `T√¨m th·∫•y ${foundItems.length} m·∫∑t h√†ng:\n\n`;
                message += '<table class="data-table">';
                message += '<tr><th>M√£ h√†ng</th><th>T√™n h√†ng</th><th>T·ªìn kho</th><th>ƒê∆°n v·ªã</th></tr>';
                
                foundItems.slice(0, 10).forEach(item => {
                    const quantity = item['S·ªë l∆∞·ª£ng'] || item['S·ªë l∆∞·ª£ng t·ªìn'] || item['T·ªìn kho'] || 0;
                    const unit = item['ƒê∆°n v·ªã'] || 'c√°i';
                    const name = item['T√™n h√†ng'] || item['T√™n s·∫£n ph·∫©m'] || 'N/A';
                    const code = item['M√£ h√†ng'] || item['M√£'] || 'N/A';
                    
                    message += `<tr>`;
                    message += `<td>${code}</td>`;
                    message += `<td>${name}</td>`;
                    message += `<td class="${quantity < 10 ? 'low-stock' : 'in-stock'}">${quantity}</td>`;
                    message += `<td>${unit}</td>`;
                    message += `</tr>`;
                });
                
                message += '</table>';
                
                if (foundItems.length > 10) {
                    message += `\n... v√† ${foundItems.length - 10} m·∫∑t h√†ng kh√°c`;
                }
                
                addBotMessage(message);
            }
        }
        
        function checkLowStock() {
            const lowStockItems = inventoryData.filter(item => {
                const quantity = parseInt(item['S·ªë l∆∞·ª£ng'] || item['S·ªë l∆∞·ª£ng t·ªìn'] || item['T·ªìn kho'] || 0);
                return quantity < 10; // Threshold for low stock
            });
            
            if (lowStockItems.length === 0) {
                addBotMessage('‚úÖ Tin t·ªët! Kh√¥ng c√≥ m·∫∑t h√†ng n√†o s·∫Øp h·∫øt.');
            } else {
                let message = `‚ö†Ô∏è C√≥ ${lowStockItems.length} m·∫∑t h√†ng s·∫Øp h·∫øt:\n\n`;
                message += '<table class="data-table">';
                message += '<tr><th>M√£ h√†ng</th><th>T√™n h√†ng</th><th>C√≤n l·∫°i</th><th>ƒê∆°n v·ªã</th></tr>';
                
                lowStockItems.forEach(item => {
                    const quantity = item['S·ªë l∆∞·ª£ng'] || item['S·ªë l∆∞·ª£ng t·ªìn'] || item['T·ªìn kho'] || 0;
                    const unit = item['ƒê∆°n v·ªã'] || 'c√°i';
                    const name = item['T√™n h√†ng'] || item['T√™n s·∫£n ph·∫©m'] || 'N/A';
                    const code = item['M√£ h√†ng'] || item['M√£'] || 'N/A';
                    
                    message += `<tr>`;
                    message += `<td>${code}</td>`;
                    message += `<td>${name}</td>`;
                    message += `<td class="low-stock">${quantity}</td>`;
                    message += `<td>${unit}</td>`;
                    message += `</tr>`;
                });
                
                message += '</table>';
                message += '\n<div class="warning-message">üí° Khuy·∫øn ngh·ªã: N√™n ƒë·∫∑t h√†ng b·ªï sung cho c√°c m·∫∑t h√†ng n√†y</div>';
                
                addBotMessage(message);
            }
        }
        
        function calculateInventoryValue() {
            let totalValue = 0;
            let itemsWithPrice = 0;
            
            inventoryData.forEach(item => {
                const quantity = parseFloat(item['S·ªë l∆∞·ª£ng'] || item['S·ªë l∆∞·ª£ng t·ªìn'] || item['T·ªìn kho'] || 0);
                const price = parseFloat(item['ƒê∆°n gi√°'] || item['Gi√°'] || item['Price'] || 0);
                
                if (price > 0) {
                    totalValue += quantity * price;
                    itemsWithPrice++;
                }
            });
            
            if (itemsWithPrice === 0) {
                addBotMessage('‚ùå Kh√¥ng t√¨m th·∫•y th√¥ng tin gi√° trong file Excel. Vui l√≤ng ƒë·∫£m b·∫£o file c√≥ c·ªôt "ƒê∆°n gi√°" ho·∫∑c "Gi√°".');
            } else {
                let message = `üí∞ **T·ªïng gi√° tr·ªã t·ªìn kho:**\n\n`;
                message += `‚Ä¢ T·ªïng gi√° tr·ªã: **${totalValue.toLocaleString('vi-VN')} VNƒê**\n`;
                message += `‚Ä¢ S·ªë m·∫∑t h√†ng c√≥ gi√°: ${itemsWithPrice}/${inventoryData.length}\n`;
                
                if (itemsWithPrice < inventoryData.length) {
                    message += `\n<div class="info-message">üìå L∆∞u √Ω: C√≥ ${inventoryData.length - itemsWithPrice} m·∫∑t h√†ng ch∆∞a c√≥ th√¥ng tin gi√°</div>`;
                }
                
                addBotMessage(message);
            }
        }
        
        function showTotalItems() {
            const totalItems = inventoryData.length;
            const totalQuantity = inventoryData.reduce((sum, item) => {
                return sum + parseInt(item['S·ªë l∆∞·ª£ng'] || item['S·ªë l∆∞·ª£ng t·ªìn'] || 0);
            }, 0);
            
            let message = `üìä **Th·ªëng k√™ kho h√†ng:**\n\n`;
            message += `‚Ä¢ T·ªïng s·ªë m·∫∑t h√†ng: **${totalItems}**\n`;
            message += `‚Ä¢ T·ªïng s·ªë l∆∞·ª£ng: **${totalQuantity.toLocaleString('vi-VN')}** (t·∫•t c·∫£ m·∫∑t h√†ng)\n`;
            
            // Categories if available
            const categories = [...new Set(inventoryData.map(item => item['Lo·∫°i'] || item['Danh m·ª•c'] || item['Category']))];
            if (categories.length > 1 && categories[0]) {
                message += `‚Ä¢ S·ªë danh m·ª•c: ${categories.length}\n`;
            }
            
            addBotMessage(message);
        }
        
        function searchItems(query) {
            const searchTerm = query.replace(/t√¨m|search|ki·∫øm/gi, '').trim().toLowerCase();
            
            const results = inventoryData.filter(item => {
                const searchableText = Object.values(item).join(' ').toLowerCase();
                return searchableText.includes(searchTerm);
            });
            
            if (results.length === 0) {
                addBotMessage(`‚ùå Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o cho "${searchTerm}"`);
            } else {
                let message = `üîç T√¨m th·∫•y ${results.length} k·∫øt qu·∫£:\n\n`;
                message += '<table class="data-table">';
                message += '<tr><th>M√£</th><th>T√™n h√†ng</th><th>T·ªìn kho</th></tr>';
                
                results.slice(0, 10).forEach(item => {
                    const code = item['M√£ h√†ng'] || item['M√£'] || 'N/A';
                    const name = item['T√™n h√†ng'] || item['T√™n s·∫£n ph·∫©m'] || 'N/A';
                    const quantity = item['S·ªë l∆∞·ª£ng'] || item['S·ªë l∆∞·ª£ng t·ªìn'] || 0;
                    
                    message += `<tr>`;
                    message += `<td>${code}</td>`;
                    message += `<td>${name}</td>`;
                    message += `<td>${quantity}</td>`;
                    message += `</tr>`;
                });
                
                message += '</table>';
                
                if (results.length > 10) {
                    message += `\n... v√† ${results.length - 10} k·∫øt qu·∫£ kh√°c`;
                }
                
                addBotMessage(message);
            }
        }
        
        function showProductDetails(query) {
            const productName = query.replace(/th√¥ng tin|chi ti·∫øt|v·ªÅ/gi, '').trim();
            findProductInQuery(productName);
        }
        
        function findProductInQuery(query) {
            const words = query.toLowerCase().split(' ').filter(w => w.length > 2);
            let bestMatch = null;
            let maxScore = 0;
            
            inventoryData.forEach(item => {
                let score = 0;
                const itemText = Object.values(item).join(' ').toLowerCase();
                
                words.forEach(word => {
                    if (itemText.includes(word)) {
                        score++;
                    }
                });
                
                if (score > maxScore) {
                    maxScore = score;
                    bestMatch = item;
                }
            });
            
            if (bestMatch && maxScore > 0) {
                showFullProductInfo(bestMatch);
            } else {
                addBotMessage('‚ùì T√¥i kh√¥ng hi·ªÉu c√¢u h·ªèi c·ªßa b·∫°n. B·∫°n c√≥ th·ªÉ h·ªèi:\n‚Ä¢ S·ªë l∆∞·ª£ng t·ªìn kho c·ªßa [t√™n h√†ng]\n‚Ä¢ H√†ng n√†o s·∫Øp h·∫øt?\n‚Ä¢ T·ªïng gi√° tr·ªã t·ªìn kho?');
            }
        }
        
        function showFullProductInfo(item) {
            let message = `üì¶ **Th√¥ng tin chi ti·∫øt:**\n\n`;
            
            // Show all available fields
            Object.entries(item).forEach(([key, value]) => {
                if (value) {
                    message += `‚Ä¢ ${key}: **${value}**\n`;
                }
            });
            
            const quantity = parseInt(item['S·ªë l∆∞·ª£ng'] || item['S·ªë l∆∞·ª£ng t·ªìn'] || 0);
            if (quantity < 10) {
                message += '\n<div class="warning-message">‚ö†Ô∏è M·∫∑t h√†ng n√†y s·∫Øp h·∫øt!</div>';
            }
            
            addBotMessage(message);
        }
        
        function showAllItems() {
            let message = 'üìã **Danh s√°ch t·ªìn kho:**\n\n';
            message += '<table class="data-table">';
            message += '<tr>';
            
            // Show first 5 columns
            const columnsToShow = headers.slice(0, 5);
            columnsToShow.forEach(header => {
                message += `<th>${header}</th>`;
            });
            message += '</tr>';
            
            // Show first 20 items
            inventoryData.slice(0, 20).forEach(item =>
